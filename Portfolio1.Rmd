---
title: "Logistic Regression Modeling"
output:
  html_document:
    toc: true
    toc_float: true
    collapsed: false
    number_sections: false
    toc_depth: 2
    #code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message=FALSE,warning=FALSE, cache=TRUE)
```


# 1:Introduction
In the recent past, minorities in Tacoma, Washington were denied access to home loans based on where they lived. This practice is known as redlining because property assessors would create maps with minority communities outlined in red. The red outline told bankers those minority communities were not fit for loans. The consequence of redlining was a significant disparity in mortgage loans and homeownership rates between white communities and minority communities.

Today, banks donâ€™t practice redlining, but disparities in mortgage loans and homeownership still exist at a significant rate. For example, the average homeownership rate in the West Census Region is 59.3 %; however, the average homeownership rate for minorities (47.9 %) is 11.4 points below the West Census Region's average, and 25.2 points below their white peers (73.1 %).

Homeownership is an effective wealth generating tool. According to a study conducted by the Demos organization, if disparites in homeownership rates were closed; the wealth gap between white and black families decreased by 31 %. Because of these circumstances, an analysis of home mortgage data to discover patterns in loan approval / denial rates in the Tacoma-Lakewwood area is warranted.


## 1.1: Data
Analysis began by gathering data from the Consumer Financial Protection Bureau (CFPB). The CFPB provides access to loan-level data so that trends in mortgage applications can be monitored. Action taken on loan applications, HUD median income, loan amount, appliancts income, race and ethnicity, gender, loan type and purpose are some of the variables that are included in the dataset from the CFPB. For this analyses, the mortgage dataset included 35,000 observations for the Tacoma-Lakewood area, of which 85 % of the applicants were approved for mortgages. 

## 1.2: Methods
To guide the modeling approach, the process began with the assumption that minorities were denied mortgage loans at a greater rate than non-minorites when controlling for loan amount,income and other factors. This hypothesis was based on trends in homeownership rates. Furthermore, logistic regression was used to generate the probability of the rejection of a mortgage loan based on race.

# 2: Exploratory Analysis
Exploratory analysis was used to understand how categorical variables were related and the associations between continuous, independent variables.

## 2:1 Exploratory Analysis of Categorical Variables

Variables such as applicant_sex, applicant_race were used to conduct a series of t-test and chi-square test to determine the significance of differences in mortgage denial rates. The full table and the results of the significance test are included in the Appendix here. As an example, test were conducted a to determine whether the denial rates for minorities was significantly different from non-minoirties. Figure 1 shows the overall approval and denial rates for mortgage loans, of which roughly 85 % were approved and 15 % denied.

### Figure 1
![](images/Rplot2.png)




## 2:2 Exploratory Analysis by Race and Loan Status
After obtaining the overall breakdown of loan approvals and denials, the analysis focused on the distribution of loan approvals and denials across race. The chi-square results indicated a significant relationship between between race and action taken by financial institution. The tables in the appendix show that minorites have an average approval probability of 79%, which is roughly 6 points lower than non-minorities. In terms of an odds ratio, non-minorities have a 5.91 to 1 chance of receiving approval; and minorities have 3.79 to 1 chance of receiving approval, which is 64 % less than non-minorities.

### Figure 2
![](images/Rplot4_race.png)






# 3: Data Screening and Processing
The data wrangling process began by checking for errors, missing data, outliers, and testing assumptions. The table function in R was used to examine categorical variables for miscoded data and mislabeled categories. Fortunately, there were no issues with categorical variables. Next, the summary function identified which continuous variables had missing values. The variable applicant_income_000s had 1306 missing values. To solve this problem, an imputation function imputed values to the missing data. Once that problem was solved, graphical analysis and test of normality indicated that the variables applicant_income_000s and loan_amount_000s had to be transformed to reduce skewness. And lastly, categorical variables were converted to binary variables.

## Appendix
### Chi-square test
```{r echo=FALSE}
tac<-read.csv("Tacoma.csv",header = T)
table(tac$action_taken_name,tac$applicant_race_name_1)
(tab2<-table(tac$action_taken_name,tac$applicant_race_name_1))
rowSums(tab2)
colSums(tab2)
prop.table(table(tac$action_taken_name,tac$applicant_race_name_1))*100
prop.table(table(tac$action_taken_name,tac$applicant_race_name_1),margin = 2)*100
(tab3<-prop.table(table(tac$action_taken_name,tac$applicant_race_name_1),margin = 2)*100)



```
The chi squared test was used to determine if their is a significant relationship between race and loan action taken by financial institutions.
```{r echo=FALSE}
chisq.test(tac$action_taken_name,tac$applicant_race_name_1)
```











